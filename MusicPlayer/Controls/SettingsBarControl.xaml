<UserControl x:Class="MusicPlayer.Controls.SettingsBarControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml" 
             xmlns:converters="clr-namespace:MusicPlayer.Converters"
             xmlns:Helper="clr-namespace:MusicPlayer.Helper"
             mc:Ignorable="d">

    <UserControl.Resources>
        <ResourceDictionary>
            <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
         
        </ResourceDictionary>
    </UserControl.Resources>

    <Border  Opacity="{Binding ButtonsOpacity}">
        <Border.Effect>
            <DropShadowEffect ShadowDepth="1" BlurRadius="8" Color="Black" Opacity="0.2"/>
        </Border.Effect>
        <StackPanel HorizontalAlignment="Stretch" VerticalAlignment="Stretch" MinWidth="60" MinHeight="120"
               Helper:StackPanelMouseBehavior.MouseEnterCommand="{Binding MouseEnterCommand}"
                Helper:StackPanelMouseBehavior.MouseLeaveCommand="{Binding MouseLeaveCommand}">
        <!-- 收纳按钮 -->
        <ui:Button Padding="0" 
                   HorizontalAlignment="Left"   
                   Width="{Binding AreOtherButtonsVisible, Converter={x:Static converters:BoolToWidthConverter.Instance}}"
                   HorizontalContentAlignment="Left"
                   Command="{Binding ToggleButtonsVisibilityCommand}">
            <Helper:CustomIcon HorizontalAlignment="Left" Margin="5,2"   >
                <Helper:CustomIcon.Style>
                    <Style TargetType="Helper:CustomIcon" BasedOn="{StaticResource {x:Type Helper:CustomIcon}}">
                        <Setter Property="Kind" Value="BackHome"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding AreOtherButtonsVisible}" Value="True">
                                <Setter Property="Kind" Value="InHome"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Helper:CustomIcon.Style>
            </Helper:CustomIcon>
        </ui:Button>

        <!-- 导航列表 -->
        <ListBox Margin="5"
            ItemsSource="{Binding NavigationItems}"
            SelectedItem="{Binding SelectedNavigationItem, Mode=TwoWay}"
            Background="Transparent"
            BorderThickness="0"
            Padding="0"
            HorizontalContentAlignment="Stretch">
                <ListBox.ItemContainerStyle>
                    <Style TargetType="ListBoxItem">
                        <!-- 优化虚拟化性能的设置 -->
                        <Setter Property="Padding" Value="0,10"/>
                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                        <Setter Property="VerticalContentAlignment" Value="Stretch"/>
                        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>

                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="ListBoxItem">
                                    <Border x:Name="ItemBorder" CornerRadius="8"  Height="40" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">
                                        <ContentPresenter/>
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>

                        <Style.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="#4DFFFFFF"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="False">
                                <Setter Property="Background" Value="Transparent"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#80FFFFFF" />
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </ListBox.ItemContainerStyle>
                <ListBox.ItemTemplate>
                <DataTemplate> 
                    <StackPanel 
                        Orientation="Horizontal" 
                        HorizontalAlignment="Left" 
                        VerticalAlignment="Center"
                        Cursor="Hand" 
                        ToolTip="{Binding Name}">
                        <Helper:CustomIcon HorizontalAlignment="Left" Margin="5,2"  >
                            <Helper:CustomIcon.Style>
                                <Style TargetType="Helper:CustomIcon" BasedOn="{StaticResource {x:Type Helper:CustomIcon}}">
                                    <Setter Property="Kind" Value="{Binding IconKind}"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=ListBoxItem}}" Value="True">
                                            <Setter Property="Kind" Value="{Binding SelectedIconKind}"/>
                                        </DataTrigger>
                                      
                                    </Style.Triggers>
                                </Style>
                            </Helper:CustomIcon.Style>
                        </Helper:CustomIcon>
                        <Separator Margin="2" />
                        <ui:TextBlock 
                            Margin="2" 
                            Text="{Binding Name}"  
                            FontWeight="SemiBold" 
                            Visibility="{Binding DataContext.AreOtherButtonsVisible, RelativeSource={RelativeSource AncestorType=UserControl}, 
                            Converter={StaticResource BooleanToVisibilityConverter}}" />
                    </StackPanel> 
                    </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
      
    </StackPanel>
    </Border>
</UserControl>